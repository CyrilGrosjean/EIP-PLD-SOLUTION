import { database } from "../database.js";
import { jsPDF } from "jspdf";
import moment from "moment";


const sprintPhases = [
  'Kickoff',
  'Follow-up',
  'Delivery'
];

const generatePDF = async (myObject, projectName, sprintNumber, sprintPhase, users) => {
  const documentName = 'test.pdf';
  const doc = new jsPDF();
  const month = moment().format('MM/YYYY');
  let categoryIndex = 0;
  let cardIndex = 0;

  // print Project Name, sprintNumber, sprintPhase, month at the center of the page in bold and bigger font
  doc.setFontSize(30);
  doc.text('PLD', 105, 80, { align: 'center' });
  doc.setFontSize(40);
  doc.setFont('helvetica', 'bold');
  doc.text(projectName, 105, 100, { align: 'center' });
  doc.setFontSize(35);
  doc.setFont('helvetica', 'normal');
  doc.text(`Sprint ${sprintNumber} - ${sprintPhase}`, 105, 120, { align: 'center' });
  doc.text(month, 105, 140, { align: 'center' });

  if (myObject.length === 0) { doc.save(documentName); return { error: false, message: 'PDF generated' } }

  const pageHeight = doc.internal.pageSize.height;
  const pageWidth = doc.internal.pageSize.width;
  for (const category of myObject) {
    if (category.cards.length === 0) continue;
    categoryIndex++;
    doc.addPage();
    doc.setFontSize(35);
    doc.setFont('helvetica', 'bold');
    doc.text(category.category, 105, 120, { align: 'center' });
    cardIndex = 0;
    for (const card of category.cards) {
      console.log('card', card);
      doc.addPage();
      const imgData = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlMAAANJCAYAAAAoe7mhAAABJ2lDQ1BrQ0dDb2xvclNwYWNlQWRvYmVSR0IxOTk4AAAokWNgYFJILCjIYRJgYMjNKykKcndSiIiMUmB/xsDJwMcgyCDAoJiYXFzgGBDgwwAEMBoVfLvGwAiiL+uCzMKUxwu4UlKLk4H0HyDOTi4oKmFgYMwAspXLSwpA7B4gWyQpG8xeAGIXAR0IZG8BsdMh7BNgNRD2HbCakCBnIPsDkM2XBGYzgeziS4ewBUBsqL0gIOiYkp+UqgDyvYahpaWFJol+IAhKUitKQLRzfkFlUWZ6RomCIzCkUhU885L1dBSMDIyMGBhA4Q5R/TkQHJ6MYmcQYgiAEJsjwcDgv5SBgeUPQsykl4FhgQ4DA/9UhJiaIQODgD4Dw745yaVFZVBjGJmMGRgI8QEaykpTjwDvCAAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAACU6ADAAQAAAABAAADSQAAAACvAtkvAABAAElEQVR4Ae3dB5wdZdk34HvTOxA6JKETBKQZkaJ0FEGxoNjFz4Ide6OIgmBBFOurYsGCSBEQEZAuRem9BQSRJjUFSCB1v5kJ57BJNsseZk54DnMNv7Czc+Z5zj3XPbv8d2Y2dHVnS1gIECBAgAABAgSel8CA5zXKIAIECBAgQIAAgUJAmHIiECBAgAABAgRKCAhTJfAMJUCAAAECBAgIU84BAgQIECBAgEAJAWGqBJ6hBAgQIECAAAFhyjlAgAABAgQIECghIEyVwDOUAAECBAgQICBMOQcIECBAgAABAiUEhKkSeIYSIECAAAECBIQp5wABAgQIECBAoISAMFUCz1ACBAgQIECAgDDlHCBAgAABAgQIlBAQpkrgGUqAAAECBAgQEKacAwQIECBAgACBEgLCVAk8QwkQIECAAAECwpRzgAABAgQIECBQQkCYKoFnKAECBAgQIEBAmHIOECBAgAABAgRKCAhTJfAMJUCAAAECBAgIU84BAgQIECBAgEAJAWGqBJ6hBAgQIECAAAFhyjlAgAABAgQIECghIEyVwDOUAAECBAgQICBMOQcIECBAgAABAiUEhKkSeIYSIECAAAECBIQp5wABAgQIECBAoISAMFUCz1ACBAgQIECAgDDlHCBAgAABAgQIlBAQpkrgGUqAAAECBAgQEKacAwQIECBAgACBEgLCVAk8QwkQIECAAAECwpRzgAABAgQIECBQQkCYKoFnKAECBAgQIEBAmHIOECBAgAABAgRKCAhTJfAMJUCAAAECBAgIU84BAgQIECBAgEAJAWGqBJ6hBAgQIECAAAFhyjlAgAABAgQIECghIEyVwDOUAAECBAgQICBMOQcIECBAgAABAiUEhKkSeIYSIECAAAECBIQp5wABAgQIECBAoISAMFUCz1ACBAgQIECAgDDlHCBAgAABAgQIlBAQpkrgGUqAAAECBAgQEKacAwQIECBAgACBEgLCVAk8QwkQIECAAAECwpRzgAABAgQIECBQQkCYKoFnKAECBAgQIEBAmHIOECBAgAABAgRKCAhTJfAMJUCAAAECBAgIU84BAgQIECBAgEAJAWGqBJ6hBAgQIECAAAFhyjlAgAABAgQIECghIEyVwDOUAAECBAgQICBMOQcIECBAgAABAiUEhKkSeIYSIECAAAECBIQp5wABAgQIECBAoISAMFUCz1ACBAgQIECAgDDlHCBAgAABAgQIlBAQpkrgGUqAAAECBAgQEKacAwQIECBAgACBEgLCVAk8QwkQIECAAAECwpRzgAABAgQIECBQQkCYKoFnKAECBAgQIEBAmHIOECBAgAABAgRKCAhTJfAMJUCAAAECBAgIU84BAgQIECBAgEAJAWGqBJ6hBAgQIECAAIFB7SCYNGlSbLbZZjF//vx2TG9OAgQIECBAgEAlAjfeeGOccMIJsdZaaz3v+doSpvJqtt122xgxYsTzLsxAAgQIECBAgEC7BW6++ebSF3+6urOl6kLHjx8f119/fYwdO7bqqc1HgAABAgQIEKhMYOLEiXHeeefFuHHjnvecnpl63nQGEiBAgAABAgQihClnAQECBAgQIECghIAwVQLPUAIECBAgQICAMOUcIECAAAECBAiUEBCmSuAZSoAAAQIECBAQppwDBAgQIECAAIESAsJUCTxDCRAgQIAAAQLClHOAAAECBAgQIFBCQJgqgWcoAQIECBAgQECYcg4QIECAAAECBEoICFMl8AwlQIAAAQIECAhTzgECBAgQIECAQAkBYaoEnqEECBAgQIAAAWHKOUCAAAECBAgQKCEgTJXAM5QAAQIECBAgIEw5BwgQIECAAAECJQSEqRJ4hhIgQIAAAQIE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muUW3yOe+X6Vb8w/z3/Iyv9YCHS6QFd2aXbha7MVHNH48ePj1DMujjFjxlYw24t7iulZ4Mkf2h6RXUXKl/zvZcmvAi26nj8Plf+23qjRY4oHwQcNGlT8SnERXLJvRl/87Ifj4uzXkI89/sw4+6zT4ntHHBKnnn5REWLyv/fl0eyW37LZ7cA8xCy69PZ6/vBofqtx+RVWbH6zy7flv4GY17CkOvO/a2bIkCGL1Z9veHz6tGJcPmdj6e29G6/lvzI9P6s9v+JmWbLA8KED46lZ85a8g1cItFkg/1p94onHm48g5L/AMnLkqPjdcX9tvnP+n5r86z3/3pUvi37e3NEKgaUssMeuk+L888/PfvN03PN+Z7f5njddNQPz5516Lo0glW/rud4IW/n2xjejxsd8215vfXfccvMN8abXbVfcQtzvM18pglT+Wh64Gs8w5Z8vuvT2ev6NMP/Tc+n5ec/aeq43glQ+ruf2/PMx2QPwiy69vXdjn+L4nvnG29jmIwEC6QnkX6v5X8OSL3lgyq9o97wqlW/Pr0D1/J616Of5PhYCnSrQlitTkyZNivfss28My/6+o3yZM3d+9mNIpxKpm0BiAtldkcGDFtxGnZ5d7Yv53bHMcs+G8jlzsq83CwECBAgsUWDQoGdvMf/y5z+M4447LtZdd90l7v9cL7TtytSN119R/Gr8cxXgdQIEnr/AlClTsl9gGJbdJh7x/CcxkgABAjUXyO+SlFnacmWqTEHGEiBAgAABAgQ6SWDBvYJOqlitBAgQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBISphJqhFAIECBAgQKDzBISpzuuZigkQIECAAIGEBP4/MFW2F14XRSYAAAAASUVORK5CYII=";
      console.log('ADDING IMAGE')
      doc.addImage(imgData, 'PNG', 0, 0, pageWidth, pageHeight);
      console.log('IMAGE ADDED');
      cardIndex++;
      // display card category in bold
      doc.setFontSize(26);
      doc.setFont('helvetica', 'bold');
      doc.text(card.category_name, 105, 36, { align: 'center', maxWidth: 190 });

      doc.setFontSize(20);
      doc.setFont('helvetica', 'bold');
      if (card.card_name.length > 50) {
        doc.text(`${categoryIndex}.${cardIndex} ${card.card_name}`, 15, 46, { align: 'left', maxWidth: 180 });
      } else {
        doc.text(`${categoryIndex}.${cardIndex} ${card.card_name}`, 15, 50, { align: 'left', maxWidth: 180 })
      }
      doc.setFontSize(15);
      doc.setFont('helvetica', 'normal');
      doc.text(`As a: ${card.card_as_a}`, 12, 72, { align: 'left', maxWidth: 65 });
      doc.text(`I want: ${card.card_i_want_to}`, 90, 72, { align: 'left', maxWidth: 108 });
      doc.text(`Description:\n ${card.card_description}`, 12, 100, { align: 'left', maxWidth: 180 });
      doc.text(`Definition of Done:\n ${card.card_definition_of_done}`, 12, 140, { align: 'left', maxWidth: 180 });
      doc.text(`${card.card_estimated_time}`, 150, 262, { align: 'left' });
    }
  }
  // wait for the pdf to be generated
  console.log('SAVING DOCUMENT');
  doc.save(documentName);
  return { error: false, message: "PDF generated" };
}

export const exportPDF = async (projectName, sprintNumber, sprintPhase) => {
  const obj = [];

  if (sprintPhases.includes(sprintPhase) === false) {
    return { error: true, message: "Sprint phase not valid" };
  }

  const [users, fields1] = await database.execute(
    "SELECT uuid, username FROM users"
  );
  console.log('users', users);
  const [categories, fields] = await database.execute(
    "SELECT * FROM categories"
  );
  console.log('categories == ', categories);
  for (const category of categories) {
    const [cards, fields] = await database.execute(
      "SELECT * FROM cards WHERE category_name = ?",
      [category.category_name]
    );
    obj.push({ category: category.category_name, cards: cards });
  }
  console.log('obj: ',obj);

  return generatePDF(obj, projectName, sprintNumber, sprintPhase, users);
}